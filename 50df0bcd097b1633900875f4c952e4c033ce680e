{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "039a20bf_466aafa5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1247893
      },
      "writtenOn": "2021-05-04T21:43:11Z",
      "side": 1,
      "message": "Could you help me understand what\u0027s broken here please? (I don\u0027t have permission to read the linked bug ticket.) Presumably the breakage is not in Chromium at all - just when we try to use this libjpeg-turbo elsewhere as a system library and none of the symbols match (standard libjpeg) with the jpeglibmangler in place?",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "85c8666d_523344ee",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1004789
      },
      "writtenOn": "2021-05-04T22:01:11Z",
      "side": 1,
      "message": "i can\u0027t actually vote, but you\u0027d have my +1 if i could :-) ",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "125fd236_869f3e55",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1004789
      },
      "writtenOn": "2021-05-04T22:01:11Z",
      "side": 1,
      "message": "exactly. (specifically in Android, where i can\u0027t update past this CL for that reason.)",
      "parentUuid": "039a20bf_466aafa5",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "686a546e_3a3dd7c0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1247893
      },
      "writtenOn": "2021-05-04T22:11:48Z",
      "side": 1,
      "message": "Ok, thanks for clarifying. In that case, would it be better to define a new flag in the Chromium BUILD.gn (CHROME, say?) and guard on that so we don\u0027t break the \"use_system_libjpeg\" option for Android Chromium builds?\n\nI broke that flag by forgetting to include jpeglibmangler.h when updating to 2.1 beta 1: https://chromium-review.googlesource.com/c/chromium/deps/libjpeg_turbo/+/2714822",
      "parentUuid": "125fd236_869f3e55",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c603e00c_7bf0eddf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000164
      },
      "writtenOn": "2021-05-05T16:49:54Z",
      "side": 1,
      "message": "I *thought* that __ANDROID__ should only be defined when building the Android platform, but maybe I\u0027m misremembering? That said, I\u0027m fine with using a more specific build flag.\n\nMy GN skills aren\u0027t very solid - I think that would mean we\u0027d add a \"define\" (something like MANGLE_JPEG_NAMES?) anywhere we include jpeglib.h, and change jpeglib.h to say\n\n  #ifdef MANGLE_JPEG_NAMES\n     #include \"jpeglibmangler.h\"\n  #endif\n\n?\n\njpeglib.h is currently part of a \"source_set\" [1]; I think we\u0027d need to change that to something else so it can still be included? I think we\u0027ll need to make sure that propagates to other projects, like libyuv, which depends on libjpeg_turbo.\n\n[1] https://source.chromium.org/chromium/chromium/src/+/main:third_party/libjpeg_turbo/BUILD.gn;l\u003d15",
      "parentUuid": "686a546e_3a3dd7c0",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9dc793fc_cf3e10af",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1004789
      },
      "writtenOn": "2021-05-05T17:04:01Z",
      "side": 1,
      "message": "\u003e I *thought* that __ANDROID__ should only be defined when building the Android platform, but maybe I\u0027m misremembering?\n\nno, __ANDROID__ is defined if you\u0027re targeting Android (either as part of the OS itself or as part of an app).",
      "parentUuid": "c603e00c_7bf0eddf",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d300590_9753e0d0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1247893
      },
      "writtenOn": "2021-05-05T20:23:55Z",
      "side": 1,
      "message": "It should work fine just to create a \u0027defines\u0027 block for that source_set underneath the \u0027sources\u0027 block - look further down the file for similar examples. (I think MANGLE_JPEG_NAMES is a good name.)\n\nI\u0027m not quite following the second part - why does it need to be included anywhere other than in the jpeglib.h as is currently the case?",
      "parentUuid": "9dc793fc_cf3e10af",
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "502ff688_781e2b72",
        "filename": "jpeglib.h",
        "patchSetId": 1
      },
      "lineNbr": 22,
      "author": {
        "id": 1000164
      },
      "writtenOn": "2021-05-04T21:26:40Z",
      "side": 1,
      "message": "I reversed this from my original suggestion [1], since this ifndef is also an edit to the Chromium fork.\n\n[1] https://buganizer.corp.google.com/issues/184745328#comment2",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 22,
        "endChar": 19
      },
      "revId": "50df0bcd097b1633900875f4c952e4c033ce680e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}